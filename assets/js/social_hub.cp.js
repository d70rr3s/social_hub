/**
* DO NOT EDIT THIS FILE.
* See the following change record for more information,
* https://www.drupal.org/node/2815083
* @preserve
**/

function fallbackCopyTextToClipboard(text, popUpCallback) {
  var clipboard = document.createElement('textarea');
  clipboard.value = text;
  document.body.appendChild(clipboard);
  clipboard.focus();
  clipboard.select();

  try {
    document.execCommand('copy');
    popUpCallback(Drupal.t('Copied!'));
  } catch (err) {
    popUpCallback(Drupal.t('Error copying text to clipboard: ' + err), Drupal.t('Error'));
    console.error('Error copying text to clipboard', err);
  }

  document.body.removeChild(clipboard);
}

function closePopup(id) {
  var el = document.querySelector('#' + id);
  el.parentNode.removeChild(el);
}

function uniqueid() {
  var length = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 12;

  var id = '';

  do {
    id = Math.random().toString(36).substr(2, length);
  } while (id.length < length);

  return id;
}

function fallbackPopUp(content) {
  var title = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

  var id = uniqueid();
  var alStart = Drupal.t('Begins %string.', { '%string': Drupal.t('popup') });
  var alEnd = Drupal.t('Ends %string.', { '%string': Drupal.t('popup') });
  var alClose = Drupal.t('Click to close popup.');
  var template = '\n<div class="popup">\n  <span class="element-invisible">' + alStart + '</span>\n  <h2>' + title + '</h2>\n  <a class="close" href="#" onclick="closePopup(\'' + id + '\')" aria-label="' + alClose + '">&times;</a>\n  <div class="content">' + content + '</div>\n  <span class="element-invisible">' + alEnd + '</span>\n</div>\n';
  var overlay = document.createElement('div');
  overlay.id = id;
  overlay.classList.add('overlay');
  overlay.innerHTML = template;
  document.body.appendChild(overlay);
}

function copyTextToClipboard(text) {
  var popUpCallback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

  if (popUpCallback === null || !(typeof popUpCallback === 'function')) {
    popUpCallback = fallbackPopUp;
  }

  if (!navigator.clipboard) {
    fallbackCopyTextToClipboard(text, popUpCallback);
    return;
  }

  navigator.clipboard.writeText(text).then(function () {
    popUpCallback(Drupal.t('Copied!'));
  }, function (err) {
    popUpCallback(Drupal.t('Error copying text to clipboard: ' + err), Drupal.t('Error'));
    console.error('Error copying text to clipboard: ', err);
  });
}
